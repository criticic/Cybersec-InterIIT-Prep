FROM tomcat:9.0.34-jdk11-openjdk-slim

RUN apt-get update && apt-get install -y wget

RUN wget https://tomcat.apache.org/tomcat-9.0-doc/appdev/sample/sample.war -O /usr/local/tomcat/webapps/sample.war

RUN mkdir -p /usr/local/tomcat/upload
RUN mkdir -p /usr/local/tomcat/sessions

COPY context.xml /usr/local/tomcat/conf/context.xml
COPY index.jsp /usr/local/tomcat/webapps/ROOT/index.jsp
COPY commons-collections4-4.0.jar /usr/local/tomcat/lib/commons-collections4-4.0.jar

RUN chmod -R 777 /usr/local/tomcat/upload
RUN chmod -R 777 /usr/local/tomcat/sessions
RUN chmod -R 777 /tmp

EXPOSE 8080

CMD ["catalina.sh", "run"]